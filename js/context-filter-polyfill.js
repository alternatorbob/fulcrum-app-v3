var P=new Map;var U=()=>"filter"in CanvasRenderingContext2D.prototype,L=e=>{let t=document.createElement("canvas");return t.height=e.canvas.height,t.width=e.canvas.width,Object.defineProperty(t,"__skipFilterPatch",{value:!0}),t.getContext("2d")};function x(e,t){Object.defineProperty(e.prototype,"__skipFilterPatch",{writable:!0,value:!1}),Object.defineProperty(e.prototype,"__currentPathMirror",{writable:!0,value:void 0}),Object.defineProperty(t.prototype,"filter",{writable:!0,value:"none"})}var B=["__skipFilterPatch","__currentPathMirror","canvas","clearRect","filter","getImageData","globalCompositeOperation"];function G(e){Object.keys(e.prototype).filter(t=>B.indexOf(t)<0).map(t=>({member:t,descriptor:Object.getOwnPropertyDescriptor(e.prototype,t)})).filter(({descriptor:t})=>t.set).forEach(({member:t,descriptor:o})=>{let n=o;Object.defineProperty(e.prototype,t,{get:function(){return this.canvas.__skipFilterPatch?n.get.call(this):this.canvas.__currentPathMirror[t]},set:function(i){if(this.canvas.__skipFilterPatch)return n.set.call(this,i);this.canvas.__currentPathMirror||(this.canvas.__currentPathMirror=L(this)),this.canvas.__currentPathMirror[t]=i}})})}var H=["clearRect","drawImage","fill","fillRect","fillText","stroke","strokeRect","strokeText"];var Y=(e,t)=>{var o;(o=t.match(/([-a-z]+)(?:\(([\w\d\s\.%-]*)\))?/gim))==null||o.map(n=>{var i;return(i=n.match(/([-a-z]+)(?:\((.*)\))?/i))==null?void 0:i.slice(1,3)}).reduce((n,[i,r])=>P.has(i)?P.get(i)(n,...(r||"").split(" ")):n,e)},b=e=>{let t=parseFloat(e);return/%\s*?$/i.test(e)&&(t/=100),t},K=e=>{let t=parseFloat(e);switch(e.slice(t.toString().length)){case"deg":t/=360;break;case"grad":t/=400;break;case"rad":t/=2*Math.PI;break}return t},j=e=>parseFloat(e);function W(e){Object.keys(e.prototype).filter(t=>B.indexOf(t)<0).map(t=>({member:t,descriptor:Object.getOwnPropertyDescriptor(e.prototype,t)})).filter(({descriptor:t})=>t.value&&typeof t.value=="function").forEach(({member:t,descriptor:o})=>{let n=o.value;Object.defineProperty(e.prototype,t,{value:function(...i){if(this.canvas.__skipFilterPatch)return n.call(this,...i);this.canvas.__currentPathMirror||(this.canvas.__currentPathMirror=L(this));let r=this.canvas.__currentPathMirror[t](...i);if(H.includes(t)){var s=this.strokeStyle,a=this.fillStyle;Y(this.canvas.__currentPathMirror,this.filter),this.canvas.__skipFilterPatch=!0;let p;"getTransform"in this&&(p=this.getTransform(),this.setTransform(1,0,0,1,0,0)),this.drawImage(this.canvas.__currentPathMirror.canvas,0,0,this.canvas.width,this.canvas.height),p&&this.setTransform(p),this.canvas.__skipFilterPatch=!1,this.canvas.__currentPathMirror=L(this),this.strokeStyle=s,this.fillStyle=a}return r}})})}var X=e=>e;var $=(e,t="0")=>{let o=j(t);if(o<=0)return e;let{height:n,width:i}=e.canvas,r=e.getImageData(0,0,i,n),{data:s}=r,a=i-1,p=n-1,c=o+1,h=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1][o],D=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18][o],m=[],u=[],d=[],v=[],S=[],T=[],k=3,l,_,w,O;for(;k-- >0;){let C=0,g=0;for(let R=0;R<n;R++){let F=s[C]*c,E=s[C+1]*c,z=s[C+2]*c,N=s[C+3]*c;for(let y=1;y<=o;y++)l=C+((y>a?a:y)<<2),F+=s[l++],E+=s[l++],z+=s[l++],N+=s[l];for(let y=0;y<i;y++)m[g]=F,u[g]=E,d[g]=z,v[g]=N,R===0&&(S[y]=((l=y+c)<a?l:a)<<2,T[y]=(l=y-o)>0?l<<2:0),_=C+S[y],w=C+T[y],F+=s[_++]-s[w++],E+=s[_++]-s[w++],z+=s[_++]-s[w++],N+=s[_]-s[w],g++;C+=i<<2}for(let R=0;R<i;R++){let F=R,E=m[F]*c,z=u[F]*c,N=d[F]*c,y=v[F]*c;for(let I=1;I<=o;I++)F+=I>p?0:i,E+=m[F],z+=u[F],N+=d[F],y+=v[F];g=R<<2;for(let I=0;I<n;I++)s[g+3]=O=y*h>>>D,O>0?(O=255/O,s[g]=(E*h>>>D)*O,s[g+1]=(z*h>>>D)*O,s[g+2]=(N*h>>>D)*O):s[g]=s[g+1]=s[g+2]=0,R===0&&(S[I]=((l=I+c)<p?l:p)*i,T[I]=(l=I-o)>0?l*i:0),_=R+S[I],w=R+T[I],E+=m[_]-m[w],z+=u[_]-u[w],N+=d[_]-d[w],y+=v[_]-v[w],g+=i<<2}}return e.putImageData(r,0,0),e};var q=(e,t="1")=>{if(t=b(t),t===1)return e;t<0&&(t=0);let{height:o,width:n}=e.canvas,i=e.getImageData(0,0,n,o),{data:r}=i,{length:s}=r;for(let a=0;a<s;a+=4)r[a+0]*=t,r[a+1]*=t,r[a+2]*=t;return e.putImageData(i,0,0),e};var J=(e,t="1")=>{if(t=b(t),t===1)return e;t<0&&(t=0);let{height:o,width:n}=e.canvas,i=e.getImageData(0,0,n,o),{data:r}=i,{length:s}=r;for(let a=0;a<s;a+=4)r[a+0]=((r[a+0]/255-.5)*t+.5)*255,r[a+1]=((r[a+1]/255-.5)*t+.5)*255,r[a+2]=((r[a+2]/255-.5)*t+.5)*255;return e.putImageData(i,0,0),e};var Q=(e,t,o,n,i)=>{let r=document.createElement("canvas").getContext("2d"),{width:s,height:a}=e.canvas;return r.canvas.width=s,r.canvas.height=a,r.shadowOffsetX=j(t),r.shadowOffsetY=j(o),r.shadowBlur=i?j(n||"0"):0,r.shadowColor=i||n||"transparent",r.drawImage(e.canvas,0,0),e.putImageData(r.getImageData(0,0,s,a),0,0),e};var V=(e,t="0")=>{if(t=b(t),t<=0)return e;t>1&&(t=1);let{height:o,width:n}=e.canvas,i=e.getImageData(0,0,n,o),{data:r}=i,{length:s}=r;for(let a=0;a<s;a+=4){let p=r[a]*.2126+r[a+1]*.7152+r[a+2]*.0722;r[a+0]+=(p-r[a+0])*t,r[a+1]+=(p-r[a+1])*t,r[a+2]+=(p-r[a+2])*t}return e.putImageData(i,0,0),e};var Z=(e,t="0deg")=>{let o=K(t);if(o<=0)return e;let{height:n,width:i}=e.canvas,r=e.getImageData(0,0,i,n),{data:s}=r,p=(o%1+1)%1*3,c=Math.floor(p),f=p-c,h=1-f,M,D,m,u,d,v,S,T,k;switch(c){default:M=D=m=u=d=v=S=T=k=0;break;case 0:M=h,D=0,m=f,u=f,d=h,v=0,S=0,T=f,k=h;break;case 1:M=0,D=f,m=h,u=h,d=0,v=f,S=f,T=h,k=0;break;case 2:M=f,D=h,m=0,u=0,d=f,v=h,S=h,T=0,k=f;break}let l=0;for(let _=0;_<n;++_)for(let w=0;w<i;++w){l=4*(_*i+w);let O=s[l+0],C=s[l+1],g=s[l+2];s[l+0]=Math.floor(M*O+D*C+m*g),s[l+1]=Math.floor(u*O+d*C+v*g),s[l+2]=Math.floor(S*O+T*C+k*g)}return e.putImageData(r,0,0),e};var A=(e,t="0")=>{if(t=b(t),t<=0)return e;t>1&&(t=1);let{height:o,width:n}=e.canvas,i=e.getImageData(0,0,n,o),{data:r}=i,{length:s}=r;for(let a=0;a<s;a+=4)r[a+0]=Math.abs(r[a+0]-255*t),r[a+1]=Math.abs(r[a+1]-255*t),r[a+2]=Math.abs(r[a+2]-255*t);return e.putImageData(i,0,0),e};var tt=(e,t="1")=>{if(t=b(t),t<0)return e;t>1&&(t=1);let{height:o,width:n}=e.canvas,i=e.getImageData(0,0,n,o),{data:r}=i,{length:s}=r;for(let a=3;a<s;a+=4)r[a]*=t;return e.putImageData(i,0,0),e};var et=(e,t="1")=>{let o=b(t);if(o===1)return e;o<0&&(o=0);let{height:n,width:i}=e.canvas,r=e.getImageData(0,0,i,n),{data:s}=r,a=(1-o)*.3086,p=(1-o)*.6094,c=(1-o)*.082,f=i<<2;for(let h=0;h<n;h++){let M=h*f;for(let D=0;D<i;D++){let m=M+(D<<2),u=s[m+0],d=s[m+1],v=s[m+2];s[m+0]=(a+o)*u+p*d+c*v,s[m+1]=a*u+(p+o)*d+c*v,s[m+2]=a*u+p*d+(c+o)*v}}return e.putImageData(r,0,0),e};var rt=(e,t="0")=>{if(t=b(t),t<=0)return e;t>1&&(t=1);let{height:o,width:n}=e.canvas,i=e.getImageData(0,0,n,o),{data:r}=i,{length:s}=r;for(let a=0;a<s;a+=4){let p=r[a+0],c=r[a+1],f=r[a+2];r[a+0]=(.393*p+.769*c+.189*f)*t+p*(1-t),r[a+1]=(.349*p+.686*c+.168*f)*t+c*(1-t),r[a+2]=(.272*p+.534*c+.131*f)*t+f*(1-t)}return e.putImageData(i,0,0),e};P.set("none",X);P.set("blur",$);P.set("brightness",q);P.set("contrast",J);P.set("drop-shadow",Q);P.set("grayscale",V);P.set("hue-rotate",Z);P.set("invert",A);P.set("opacity",tt);P.set("saturate",et);P.set("sepia",rt);var st=typeof HTMLCanvasElement!="undefined"&&typeof CanvasRenderingContext2D!="undefined";st&&!U()&&(x(HTMLCanvasElement,CanvasRenderingContext2D),G(CanvasRenderingContext2D),W(CanvasRenderingContext2D));
//# sourceMappingURL=index.js.map